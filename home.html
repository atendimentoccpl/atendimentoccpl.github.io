<!DOCTYPE html>
<html>
<head>
<title>Random BG</title>
<style type="text/css">
html ,body{
  margin: 0;
  border: 0;
  height: 100%;
}

body{
  background-color: rgb(80,80,80);
}

#bg{
  position fixed;
  width: 100%;
  height: 100%;
  
  background-repeat: no-repeat;
  background-position: center center;
  
  -webkit-background-size: cover;
  -moz-background-size: cover;
  -o-background-size: cover;
  background-size: cover;
    
  transition: background 1s ease;
}
</style>
</head>
<body>
 
<div id="bg"></div>

<script>

var randBG=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34];
                  
function setRandomBG(i){
    var num = Math.floor(Math.random()*randBG.length);
    var bg = randBG[i?i:num];
    
    var url = "/bg/"+bg+".jpg";
  
    preload(url, function(){
        document.getElementById("bg").style.backgroundImage='url('+url+')';
        console.log(url);
    });
    
}


window.onload=function() {
     setRandomBG();
     setInterval(setRandomBG, 1000*30);
};

  
  function preload(src, callback, timeout){
    
    var preloadImg = new Image();
    
    if(timeout){
      var timer = setTimeout(function(){
        callback(null);
         preloadImg = null;
      }, timeout);
    }
    
    preloadImg.onload = function(){
        clearTimeout(timer);
        callback(src);
        preloadImg = null;
    }
    preloadImg.src = src;
  }
</script>
</body>
